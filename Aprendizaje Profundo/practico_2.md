# Práctico 2

## Desarrollo del Práctico

* Se Utilizo el mismo modelo del practico anterior y se le agregaron columnas

#### Primera Corrida con SimpleRNN

* A las columnas que se agregaron se sumo una capa SimpleRNN al modelo con los siguientes resultados.

Model: "SimpleRNN"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
description (InputLayer)        [(None, 55)]         0                                            
__________________________________________________________________________________________________
Breed1 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Breed2 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color1 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color2 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color3 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
word_embedding (Embedding)      (None, 55, 100)      1000200     description[0][0]                
__________________________________________________________________________________________________
embedding (Embedding)           (None, 1, 77)        23716       Breed1[0][0]                     
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 1, 77)        23716       Breed2[0][0]                     
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 1, 2)         16          Color1[0][0]                     
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 1, 2)         16          Color2[0][0]                     
__________________________________________________________________________________________________
embedding_4 (Embedding)         (None, 1, 2)         16          Color3[0][0]                     
__________________________________________________________________________________________________
simple_rnn (SimpleRNN)          (None, 256)          91392       word_embedding[0][0]             
__________________________________________________________________________________________________
tf_op_layer_Squeeze (TensorFlow [(None, 77)]         0           embedding[0][0]                  
__________________________________________________________________________________________________
tf_op_layer_Squeeze_1 (TensorFl [(None, 77)]         0           embedding_1[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_2 (TensorFl [(None, 2)]          0           embedding_2[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_3 (TensorFl [(None, 2)]          0           embedding_3[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_4 (TensorFl [(None, 2)]          0           embedding_4[0][0]                
__________________________________________________________________________________________________
Age (InputLayer)                [(None, 1)]          0                                            
__________________________________________________________________________________________________
Fee (InputLayer)                [(None, 1)]          0                                            
__________________________________________________________________________________________________
description_features (Dense)    (None, 512)          131584      simple_rnn[0][0]                 
__________________________________________________________________________________________________
direct_features (InputLayer)    [(None, 24)]         0                                            
__________________________________________________________________________________________________
feature_map (Concatenate)       (None, 698)          0           tf_op_layer_Squeeze[0][0]        
                                                                 tf_op_layer_Squeeze_1[0][0]      
                                                                 tf_op_layer_Squeeze_2[0][0]      
                                                                 tf_op_layer_Squeeze_3[0][0]      
                                                                 tf_op_layer_Squeeze_4[0][0]      
                                                                 Age[0][0]                        
                                                                 Fee[0][0]                        
                                                                 description_features[0][0]       
                                                                 direct_features[0][0]            
__________________________________________________________________________________________________
dense (Dense)                   (None, 128)          89472       feature_map[0][0]                
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128)          512         dense[0][0]                      
__________________________________________________________________________________________________
dropout (Dropout)               (None, 128)          0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 64)           8256        dropout[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64)           256         dense_1[0][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
output (Dense)                  (None, 5)            325         dropout_1[0][0]                  
==================================================================================================
Total params: 1,369,477
Trainable params: 368,893
Non-trainable params: 1,000,584

*** Validation loss: 1.4535391821580774 - accuracy: 0.3604156970977783

#### Segunda Corrida con GRU

* A las columnas que se agregaron se sumo una capa GRU al modelo con los siguientes resultados.

Model: "GRU"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
description (InputLayer)        [(None, 55)]         0                                            
__________________________________________________________________________________________________
Breed1 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Breed2 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color1 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color2 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color3 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
word_embedding (Embedding)      (None, 55, 100)      1000200     description[0][0]                
__________________________________________________________________________________________________
embedding (Embedding)           (None, 1, 77)        23716       Breed1[0][0]                     
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 1, 77)        23716       Breed2[0][0]                     
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 1, 2)         16          Color1[0][0]                     
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 1, 2)         16          Color2[0][0]                     
__________________________________________________________________________________________________
embedding_4 (Embedding)         (None, 1, 2)         16          Color3[0][0]                     
__________________________________________________________________________________________________
gru (GRU)                       (None, 256)          274944      word_embedding[0][0]             
__________________________________________________________________________________________________
tf_op_layer_Squeeze (TensorFlow [(None, 77)]         0           embedding[0][0]                  
__________________________________________________________________________________________________
tf_op_layer_Squeeze_1 (TensorFl [(None, 77)]         0           embedding_1[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_2 (TensorFl [(None, 2)]          0           embedding_2[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_3 (TensorFl [(None, 2)]          0           embedding_3[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_4 (TensorFl [(None, 2)]          0           embedding_4[0][0]                
__________________________________________________________________________________________________
Age (InputLayer)                [(None, 1)]          0                                            
__________________________________________________________________________________________________
Fee (InputLayer)                [(None, 1)]          0                                            
__________________________________________________________________________________________________
description_features (Dense)    (None, 512)          131584      gru[0][0]                        
__________________________________________________________________________________________________
direct_features (InputLayer)    [(None, 24)]         0                                            
__________________________________________________________________________________________________
feature_map (Concatenate)       (None, 698)          0           tf_op_layer_Squeeze[0][0]        
                                                                 tf_op_layer_Squeeze_1[0][0]      
                                                                 tf_op_layer_Squeeze_2[0][0]      
                                                                 tf_op_layer_Squeeze_3[0][0]      
                                                                 tf_op_layer_Squeeze_4[0][0]      
                                                                 Age[0][0]                        
                                                                 Fee[0][0]                        
                                                                 description_features[0][0]       
                                                                 direct_features[0][0]            
__________________________________________________________________________________________________
dense (Dense)                   (None, 128)          89472       feature_map[0][0]                
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128)          512         dense[0][0]                      
__________________________________________________________________________________________________
dropout (Dropout)               (None, 128)          0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 64)           8256        dropout[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64)           256         dense_1[0][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
output (Dense)                  (None, 5)            325         dropout_1[0][0]                  
==================================================================================================
Total params: 1,553,029
Trainable params: 552,445
Non-trainable params: 1,000,584

*** Validation loss: 1.524133373709286 - accuracy: 0.27397260069847107

* Podemos ver que utilizando GRU la performance es menor que con SimpleRNN y con un tiempo de respuesta en el entrenamiento mucho mayor

#### Tercera Corrida con LSTM

* A las columnas que se agregaron se sumo una capa LSTM al modelo con los siguientes resultados.

Model: "LSTM"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
description (InputLayer)        [(None, 55)]         0                                            
__________________________________________________________________________________________________
Breed1 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Breed2 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color1 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color2 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Color3 (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
word_embedding (Embedding)      (None, 55, 100)      1000200     description[0][0]                
__________________________________________________________________________________________________
embedding (Embedding)           (None, 1, 77)        23716       Breed1[0][0]                     
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 1, 77)        23716       Breed2[0][0]                     
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 1, 2)         16          Color1[0][0]                     
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 1, 2)         16          Color2[0][0]                     
__________________________________________________________________________________________________
embedding_4 (Embedding)         (None, 1, 2)         16          Color3[0][0]                     
__________________________________________________________________________________________________
lstm (LSTM)                     (None, 256)          365568      word_embedding[0][0]             
__________________________________________________________________________________________________
tf_op_layer_Squeeze (TensorFlow [(None, 77)]         0           embedding[0][0]                  
__________________________________________________________________________________________________
tf_op_layer_Squeeze_1 (TensorFl [(None, 77)]         0           embedding_1[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_2 (TensorFl [(None, 2)]          0           embedding_2[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_3 (TensorFl [(None, 2)]          0           embedding_3[0][0]                
__________________________________________________________________________________________________
tf_op_layer_Squeeze_4 (TensorFl [(None, 2)]          0           embedding_4[0][0]                
__________________________________________________________________________________________________
Age (InputLayer)                [(None, 1)]          0                                            
__________________________________________________________________________________________________
Fee (InputLayer)                [(None, 1)]          0                                            
__________________________________________________________________________________________________
description_features (Dense)    (None, 512)          131584      lstm[0][0]                       
__________________________________________________________________________________________________
direct_features (InputLayer)    [(None, 24)]         0                                            
__________________________________________________________________________________________________
feature_map (Concatenate)       (None, 698)          0           tf_op_layer_Squeeze[0][0]        
                                                                 tf_op_layer_Squeeze_1[0][0]      
                                                                 tf_op_layer_Squeeze_2[0][0]      
                                                                 tf_op_layer_Squeeze_3[0][0]      
                                                                 tf_op_layer_Squeeze_4[0][0]      
                                                                 Age[0][0]                        
                                                                 Fee[0][0]                        
                                                                 description_features[0][0]       
                                                                 direct_features[0][0]            
__________________________________________________________________________________________________
dense (Dense)                   (None, 128)          89472       feature_map[0][0]                
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128)          512         dense[0][0]                      
__________________________________________________________________________________________________
dropout (Dropout)               (None, 128)          0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 64)           8256        dropout[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64)           256         dense_1[0][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
output (Dense)                  (None, 5)            325         dropout_1[0][0]                  
==================================================================================================
Total params: 1,643,653
Trainable params: 643,069
Non-trainable params: 1,000,584

*** Validation loss: 1.2101612722172457 - accuracy: 0.5139347910881042

* Con LSMT conseguimos los mejores valores de exactitud y una performance de ejecución parecida a SimpleRNN.
