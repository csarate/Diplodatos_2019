---
title: "Ejercicio 2 R"
author: "Claudio Sarate"
date: "25/5/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Ejercicios.


Los valores correctos estan en la diagonal de la matriz, 98% de precision para unas pocas lineas de R!


+ Mejore el rendimiento utilizando una normalizacion con z-scores provista por la funcion scale() de R.
```{r}
data_n <- data[2:ncol(data)]
data_zscore <- scale(data_n)
data_train <- data_zscore[1:469, ]
data_test  <- data_zscore[470:569, ] 
```

```{r}
library(class)
data_test_pred <- knn(train=data_train, test=data_test, cl=data_train_labels, k=21)
```

```{r}
library(gmodels)
CrossTable(x=data_test_labels, y=data_test_pred, prop.chisq = FALSE)
```
+ Pruebe algunos valores alternativos de k=1, 5,  11, 15, 21 y seleccione el mejor valor de k.

```{r}
library(class)
data_test_pred <- knn(train=data_train, test=data_test, cl=data_train_labels, k=1)

library(gmodels)
CrossTable(x=data_test_labels, y=data_test_pred, prop.chisq = FALSE)
```

```{r}
library(class)
data_test_pred <- knn(train=data_train, test=data_test, cl=data_train_labels, k=5)

library(gmodels)
CrossTable(x=data_test_labels, y=data_test_pred, prop.chisq = FALSE)
```
```{r}
library(class)
data_test_pred <- knn(train=data_train, test=data_test, cl=data_train_labels, k=11)

library(gmodels)
CrossTable(x=data_test_labels, y=data_test_pred, prop.chisq = FALSE)
```

```{r}
library(class)
data_test_pred <- knn(train=data_train, test=data_test, cl=data_train_labels, k=15)

library(gmodels)
CrossTable(x=data_test_labels, y=data_test_pred, prop.chisq = FALSE)
```

+ Verifique si el resultado cambia utilizando paciente elegidos aleatoriamente para el conjunto de validacion.

```{r}
data <- read.csv("http://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/wdbc.data",header=FALSE)
data <- data[-1]
data
data$V2 <- factor(data$V2, levels = c("B", "M"))
data$V2 <- as.numeric(data$V2)

```


```{r}
set.seed(1)
data_random <- data[sample(nrow(data), replace = FALSE), 1:ncol(data)] 
data_zscore <- scale(data_random)
data_train <- data_zscore[1:469, ]
data_test  <- data_zscore[470:569, ] 
data_train_labels <- data_zscore[1:469, 1]
data_test_labels  <- data_zscore[470:569, 1]
data_train_labels
library(class)
data_test_pred <- knn(train=data_train, test=data_test, cl=data_train_labels, k=15)

library(gmodels)
CrossTable(x=data_test_labels, y=data_test_pred, prop.chisq = FALSE)
```

  
***